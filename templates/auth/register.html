<!-- ======= REGISTER ======= -->
<!-- auth/register.html -->
<!DOCTYPE html>
<html lang="uz">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ro'yxatdan o'tish - ShopUz</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #6366f1 0%, #4f46e5 100%); min-height: 100vh; display: flex; align-items: center; }
        .auth-card { border-radius: 24px; border: none; box-shadow: 0 24px 60px rgba(0,0,0,0.15); }
        .form-control { border-radius: 12px; border: 2px solid #e2e8f0; padding: 12px 16px; transition: border-color 0.2s; }
        .form-control:focus { border-color: #6366f1; box-shadow: none; }
        .btn-primary { background: #6366f1; border: none; border-radius: 12px; font-weight: 700; padding: 14px; }
        .btn-primary:hover { background: #4f46e5; }
        .brand { font-weight: 800; font-size: 1.6rem; color: #6366f1; }
        .brand span { color: #f59e0b; }
        .input-group-text { border-radius: 12px 0 0 12px; border: 2px solid #e2e8f0; border-right: none; background: #f8fafc; }
        .input-group .form-control { border-radius: 0 12px 12px 0; }
        .avatar-preview { width: 80px; height: 80px; border-radius: 50%; object-fit: cover; border: 3px solid #6366f1; display: none; }
    </style>
</head>
<body>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6 col-lg-5 py-5">
            <div class="auth-card card p-5">
                <div class="text-center mb-4">
                    <div class="brand mb-2">Shop<span>Uz</span></div>
                    <h4 class="fw-800">Ro'yxatdan o'tish</h4>
                    <p class="text-muted small">Hisob yarating va xarid qilishni boshlang</p>
                </div>

                {% if error %}
                <div class="alert alert-danger" style="border-radius:12px;background:#fef2f2;border:none;color:#991b1b;">
                    <i class="bi bi-exclamation-circle me-2"></i>{{ error }}
                </div>
                {% endif %}

                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    <!-- Avatar upload -->
                    <div class="text-center mb-4">
                        <div class="position-relative d-inline-block">
                            <img id="avatarPreview" class="avatar-preview" src="" alt="">
                            <label class="btn btn-outline-primary btn-sm" style="border-radius:12px;cursor:pointer;" id="uploadLabel">
                                <i class="bi bi-camera me-1"></i>Rasm tanlash
                                <input type="file" name="profile_image" accept="image/*" class="d-none" onchange="previewAvatar(this)">
                            </label>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label class="form-label fw-600">Username <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-person"></i></span>
                            <input type="text" name="username" class="form-control" placeholder="username" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-600">Email <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-envelope"></i></span>
                            <input type="email" name="email" class="form-control" placeholder="email@example.com" required>
                        </div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label fw-600">Parol <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-lock"></i></span>
                            <input type="password" name="password" id="pass1" class="form-control" placeholder="Kamida 5 ta belgi" required>
                            <button class="btn btn-outline-secondary" type="button" onclick="togglePass('pass1','eye1')" style="border-radius:0 12px 12px 0;border:2px solid #e2e8f0;border-left:none;">
                                <i class="bi bi-eye" id="eye1"></i>
                            </button>
                        </div>
                    </div>
                    <div class="mb-4">
                        <label class="form-label fw-600">Parolni tasdiqlang <span class="text-danger">*</span></label>
                        <div class="input-group">
                            <span class="input-group-text"><i class="bi bi-lock-fill"></i></span>
                            <input type="password" name="confirm_password" id="pass2" class="form-control" placeholder="Parolni qayta kiriting" required>
                            <button class="btn btn-outline-secondary" type="button" onclick="togglePass('pass2','eye2')" style="border-radius:0 12px 12px 0;border:2px solid #e2e8f0;border-left:none;">
                                <i class="bi bi-eye" id="eye2"></i>
                            </button>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 py-3">
                        Ro'yxatdan o'tish <i class="bi bi-arrow-right ms-2"></i>
                    </button>
                </form>
                <p class="text-center text-muted mt-4 mb-0">Hisobingiz bormi? <a href="{% url 'login' %}" class="fw-700 text-decoration-none" style="color:#6366f1;">Kirish</a></p>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
function previewAvatar(input) {
    if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = e => {
            const img = document.getElementById('avatarPreview');
            img.src = e.target.result;
            img.style.display = 'block';
            document.getElementById('uploadLabel').innerHTML = '<i class="bi bi-camera me-1"></i>O\'zgartirish<input type="file" name="profile_image" accept="image/*" class="d-none" onchange="previewAvatar(this)">';
        };
        reader.readAsDataURL(input.files[0]);
    }
}
function togglePass(id, iconId) {
    const input = document.getElementById(id);
    const icon = document.getElementById(iconId);
    if (input.type === 'password') { input.type = 'text'; icon.className = 'bi bi-eye-slash'; }
    else { input.type = 'password'; icon.className = 'bi bi-eye'; }
}
</script>
</body>
</html>